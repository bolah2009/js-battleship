!function(e){var t={};function a(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";a.r(t);var n=(e={element:"div",html:"",attributes:[]})=>{const{element:t="div",html:a="",attributes:n=[]}=e,s=document.createDocumentFragment(),r=document.createElement(t);return r.innerHTML=a,n.length&&n.forEach(({name:e,value:t})=>{r.setAttribute(e,t)}),s.appendChild(r),s};var s=()=>{const e=[{shipType:"carrier",noPerPlayer:1,size:5},{shipType:"battleship",noPerPlayer:1,size:4},{shipType:"cruiser",noPerPlayer:2,size:3},{shipType:"submarine",noPerPlayer:2,size:3},{shipType:"destroyer",noPerPlayer:3,size:2}],t=`<h3 class="info">\n                 Drag the ships to the grid, to rotate position click on the ship\n                </h3>\n                ${(()=>{const t=(e,t)=>`\n         <div class="port ${e}-port">\n         ${((e,t)=>`\n         <div class="${e} ship" data-name=${e} data-type="ship" id=${t} draggable=true></div>`)(e,t)}</div>`;let a="";return e.forEach(({shipType:e,noPerPlayer:n})=>{let s="",r=n;for(;r>0;){s+=t(e,`${e}-0${r}`),r-=1}a+=(e=>`<div class="ship-group d-flex">${e}</div>`)(s)}),a})()}`;return n({html:t,attributes:[{name:"class",value:"ships d-none"}]})};const r=()=>{const e=["A","B","C","D","E","F","G","H","I","J"],t=(e,t)=>`<td \n  class="cell" data-type="cell" \n  data-name=${e} data-player=${t}></td>`,a=(e,a)=>{const n=[];let s=0;for(;s<10;)n.push(t(e+s,a)),s+=1;return`<tr>${n.join("")}</tr>`},r=t=>`<table class="table">${(t=>{const n=[];let s=0;for(;s<10;)n.push(a(e[s],t)),s+=1;return`<tbody>${n.join("")}</tbody>`})(t)}</table>`,i=e=>[{name:"class",value:`table-container ${e}`}],o=n({attributes:i("player-board"),html:r("current")}),l=n({attributes:i("opponent-board"),html:r("opponent")}),c=n({attributes:[{name:"class",value:"boards-wrapper d-flex jc-c"}]});return(()=>{const e=c;return e.firstElementChild.appendChild(s()),e.firstElementChild.appendChild(o),e.firstElementChild.appendChild(l),e})()},i=()=>{const e=document.querySelector(".boards-wrapper"),t=r();e.parentNode.replaceChild(t,e)};var o=r;var l=()=>{const e=o(),t=document.createDocumentFragment();return t.appendChild(n({html:'<h1>Battleship</h1>\n                  <p id="info" class="notification">Place the ships</p>',attributes:[{name:"class",value:"status d-flex jc-sa"}],element:"header"})),t.appendChild(e),t.appendChild(n({html:'\n    <input value="Randomize" class="button" type="button" data-type="control" data-action="random"/>\n    <input value="Place Ships" class="button" type="button" data-type="control" data-action="place-ships"/>\n    <input value="Start Game"  class="button" type="button" data-type="control" data-action="start"/>  \n    <input value="Reset Game"  class="button" type="button" data-type="control" data-action="reset" disabled="true"/>\n    <label class="button computer d-none">\n      <div>Play with computer?</div>\n      <div class="choice">\n      <span id="no">No</span>\n      <span class="switch">\n      <input class="computer-player" checked type="checkbox" data-type="control" data-action="computer"/>\n      <span class="slider"></span>\n      </span>\n      <span id="yes">Yes</span>\n      </div>\n    </label>',attributes:[{name:"class",value:"control-panel d-flex jc-c"}]})),t};const c={carrier:{size:5,noPerPlayer:1,sunk:!1},battleship:{size:4,noPerPlayer:1,sunk:!1},cruiser:{size:3,noPerPlayer:2,sunk:!1},submarine:{size:3,noPerPlayer:2,sunk:!1},destroyer:{size:2,noPerPlayer:3,sunk:!1}};var d=(e,t)=>{(e=>{if(void 0===c[e])throw new Error(`${e} is a wrong type of ship`)})(e),((e,t)=>{if(e.length!==c[t].size)throw new Error(`${e} is a wrong position for ${t} ship`)})(t,e);const{size:a}=c[e],n=t,s=[];return{size:a,isSunk:()=>a===s.length,hit:e=>!(!n.includes(e)||s.includes(e))&&(s.push(e),!0),hits:s,position:t,shipType:e}};var p=(e,t=!0)=>{let a=e;const n=t,s=[];return{placeShips:({ships:e,ship:t}={})=>(t||n?a.generateRandomShips(t):e&&e.forEach(e=>a.placeShip(e)),a.isFilled()),takeTurn:(e,t)=>(s.push(t),e.receiveAttack(t)),attackedPositions:s,generateRandomPosition:()=>a.getRandomCell(s),board:a,reset:e=>(a=e,s.splice(0),a)}};const u=["A","B","C","D","E","F","G","H","I","J"],h={carrier:1,battleship:1,cruiser:2,submarine:2,destroyer:3},m={carrier:5,battleship:4,cruiser:3,submarine:3,destroyer:2};var y=()=>{const e={...h},t=[],a=[],n=[],s=[],r=[],i=[],o=()=>{Object.assign(e,h),t.splice(0),a.splice(0),n.splice(0),s.splice(0),r.splice(0),i.splice(0)},l=e=>{if(2!==e.length)return!1;const[t,a]=e;return!(!u.includes(t)||!u[a])},c=e=>!!l(e)&&!i.includes(e),d=e=>{const t=e=>!!c(e)&&(i.push(e),!0);e.forEach(e=>{const[a,n]=e,s=u.indexOf(a),r=1*n;[e,u[s-1]+r,u[s-1]+(r+1),u[s-1]+(r-1),u[s]+(r+1),u[s]+(r-1),u[s+1]+r,u[s+1]+(r+1),u[s+1]+(r-1)].forEach(t)})},p=t=>e[t]>0,y=a=>{const n=a,{position:s,shipType:i}=n;return!!(e=>{const{position:t,shipType:a}=e;return p(a)&&t.every(c)})(n)&&(e[i]-=1,r.push(...s),d(s),t.push(n),!0)},f=()=>Math.floor(10*Math.random()),v=(e=[],t=[],a=f(),n=f())=>!t.includes(u[a]+n)&&!((e,t)=>e<0||e>9||t<0||t>9)(a,n)&&(e.includes(u[a]+n)?(t.push(u[a]+n),v(e,t,a+1,n+1)||v(e,t,a+1,n-1)||v(e,t,a-1,n+1)||v(e,t,a-1,n-1)||v(e,t,a,n+1)||v(e,t,a,n-1)||v(e,t,a-1,n)||v(e,t,a+1,n)):[a,n]),b=(e,t,a)=>{const n=m[a],s=[];s.push(e);let r=1;if(t)for(;r<n;)s.push(e[0]+(1*e[1]+r)),r+=1;else{const t=u.findIndex(t=>t===e[0]);for(;r<n;)s.push(u[t+r]+e[1]),r+=1}return s};return{placeShip:y,receiveAttack:e=>{if(l(e)){if(s.includes(e))return!1;s.push(e);const r=(e=>t.find(({position:t})=>t.includes(e)))(e);return r&&r.hit(e)?(n.push(e),!0):(a.push(e),!1)}return!1},isAllSunk:()=>t.every(e=>e.isSunk()),missedAttacks:a,hitAttacks:n,generateRandomShips:a=>{o();const n=e=>{const t=e=>!!e.every(c)&&e,a=(e,t,n,s={x:1,y:0},r=[])=>{let i=n;const{y:o,x:l}=s,c=e+l,d=t+o;return r.push(u[e]+t),(i-=1)>0&&a(c,d,i,s,r),r},[n,s]=v(i);return t(a(n,s,e,{x:0,y:1}))||t(a(n,s,e,{x:1,y:0}))};return Object.keys(e).forEach(e=>{for(;p(e);){const t=n(m[e]);t&&y(a(e,t))}}),t},ships:t,isFilled:()=>Object.values(e).every(e=>0===e),getRandomCell:e=>{const[t,a]=v(e);return u[t]+a},placeShipOnBoard:(e,t,a)=>{const n=b(t,!0,a);return!!y(e(a,n))},moveShip:(a,n)=>{const s=(e=>t.findIndex(({position:t})=>t.includes(e)))(n),{position:o,shipType:l}=t[s],c=o[0][0]===o[1][0],p=()=>{t.splice(s,1),e[l]+=1,o.forEach(e=>{const t=r.findIndex(t=>t===e);r.splice(t,1)}),i.splice(0),d(r)};return{displace:e=>{p();const t=b(e,c,l);return!!y(a(l,t))||(y(a(l,o)),!1)},rotate:()=>{p();const e=b(n,!c,l);return!!y(a(l,e))||(y(a(l,o)),!1)}}},reset:o}};var f=()=>{const e=p(y(),!1);e.placeShips({ship:d});const t=p(y());t.placeShips({ship:d});let a=e,n=t,s=!1;return{randomiseShips:()=>a.board.generateRandomShips(d),clearBoard:()=>{s=!1,a.board.reset()},reset:()=>{s=!1,[e,t].forEach(e=>{e.reset(y()),e.placeShips({ship:d})})},moveShip:e=>a.board.moveShip(d,e),placeShipOnBoard:(e,t)=>{const{board:{placeShipOnBoard:n}}=a;return n(d,e,t)},start:()=>!!a.board.isFilled()&&(s=!0,!0),play:(s="")=>!!a.takeTurn(n.board,s)||(a===e?(a=t,n=e):(a=e,n=t),!1),isGameOn:()=>s,isValidAttack:e=>!a.attackedPositions.includes(e),winStatus:()=>e.board.isAllSunk()?"Player Two":!!t.board.isAllSunk()&&"Player One",randomPosition:()=>a.generateRandomPosition()}};const v=(e,t=document)=>t.querySelector(e);v("#content").appendChild(l());const b=()=>v(".ships"),g=()=>v(".player-board"),P=()=>v(".opponent-board"),S=v("#info"),k=v(".control-panel"),E=v('[data-action="random"]'),C=v('[data-action="start"]'),$=v('[data-action="reset"]'),x=v('[data-action="place-ships"]'),L=v('[data-action="computer"]'),O=f(),T=e=>{S.textContent=e},w=(e=!0)=>{const t=[L,x,E,C];$.disabled=!e,t.forEach(t=>{t.disabled=e})},j=()=>{O.randomiseShips().forEach(({position:e,shipType:t})=>{const a=(e=>v(`.ship.${e}`,b()))(t),n=(e=>v(`[data-name=${e}]`,g()))(e[0]);e.length>1&&e[0][0]!==e[1][0]&&a.classList.add("rotate"),n.appendChild(a)})},D=e=>{const{dataTransfer:t,target:a}=e;return!(!a.dataset||!a.dataset.type||"ship"!==a.dataset.type)&&(t.setData("text/plain",a.id),t.setData("shipName",a.dataset.name),t.setData("source",a.parentNode.dataset.type),t.setData("sourcePosition",a.parentNode.dataset.name),t.dropEffect="move",!0)},z=e=>{const{target:t}=e;return e.preventDefault(),!(!t.dataset||!t.dataset.type||"cell"!==t.dataset.type)},A=e=>{const{target:t,dataTransfer:a}=e;if(e.preventDefault(),!t.dataset||!t.dataset.type||"cell"!==t.dataset.type)return!1;const n=a.getData("text/plain"),s=a.getData("shipName"),r=a.getData("source"),i=a.getData("sourcePosition"),o=t.dataset.name;if("cell"===r){return O.moveShip(i).displace(o)?(t.appendChild(document.getElementById(n)),!0):(T("Sorry, Can not move ship from current position to an invalid position!"),!1)}return O.placeShipOnBoard(o,s)?(t.appendChild(document.getElementById(n)),!0):(T("Sorry, Can not move ship to an invalid position!"),!1)},B=({target:e,target:{dataset:{type:t},parentNode:{dataset:{type:a,name:n}}}})=>{t&&a&&"cell"===a&&"ship"===t&&(O.moveShip(n).rotate()?e.classList.toggle("rotate"):(e.classList.add("error"),T("Can not rotate ship, invalid position!"),setInterval(()=>e.classList.remove("error"),1500)))},R=e=>{e("dragstart",D),e("dragover",z),e("drop",A),e("dragend",D),e("click",B)},G=({target:{dataset:{type:e,action:t}}})=>{if(e&&"control"===e)switch(t){case"random":i(),j();break;case"place-ships":O.clearBoard(),i(),b().classList.remove("d-none"),P().classList.add("d-none"),T("Please, drag ships and drop on the board.");break;case"start":(()=>{if(O.start())return b().classList.add("d-none"),P().classList.remove("d-none"),w(),T("Game Starts, Player One make your move!"),void R(document.removeEventListener);T("Place all your ships or use randomise to place ships!")})();break;case"reset":O.reset(),i(),j(),T("Game Reset, Player One place your ships!"),w(!1),R(document.addEventListener)}},M=({target:e,target:{dataset:{name:t,player:a}}})=>{if(!a||"opponent"!==a||!O.isGameOn())return;const n=()=>!!O.winStatus()&&(T(`${O.winStatus()} wins the game... !!!`),document.removeEventListener("click",M),!0);if(O.isValidAttack(t))if(O.play(t))e.classList.add("attacked"),T("Good Hit! Play again..."),n();else{document.removeEventListener("click",M),e.classList.add("missed"),T("Missed Hit! Player Two time...");let t=O.randomPosition();const a=e=>v(`[data-name=${e}]`,g());for(;O.play(t);){if(T("Nice Hit! Playing again..."),a(t).classList.add("attacked"),n())return;t=O.randomPosition()}a(t).classList.add("missed"),T("Missed Hit! Player One time..."),document.addEventListener("click",M)}else T("Choose a valid position...")};R(document.addEventListener),k.addEventListener("click",G),document.addEventListener("click",M),j()}]);